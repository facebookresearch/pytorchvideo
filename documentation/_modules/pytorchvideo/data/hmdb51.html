


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pytorchvideo.data.hmdb51 &mdash; PyTorchVideo  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  
  
  
    <link rel="canonical" href="https://pytorchvideo.org/docs/_modules/pytorchvideo/data/hmdb51.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorchvideo.org" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorchvideo.org">Home</a>
          </li>
          <li>
            <a href="https://pytorchvideo.org/docs/tutorial_overview">Tutorials</a>
          </li>
          <li>
            <a href="https://github.com/facebookresearch/pytorchvideo/">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/models.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/model_zoo.html">Model Zoo and Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/models/index.html">Models API</a></li>
</ul>
<p class="caption"><span class="caption-text">Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data_preparation.html">Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/data/index.html">Data API</a></li>
</ul>
<p class="caption"><span class="caption-text">Transforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/transforms.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/transforms/index.html">Transforms API</a></li>
</ul>
<p class="caption"><span class="caption-text">Layers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/layers.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/layers/index.html">Layers API</a></li>
</ul>
<p class="caption"><span class="caption-text">Accelerator</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/accelerator.html">Overview</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../index.html">Module code</a> &gt;</li>
        
      <li>pytorchvideo.data.hmdb51</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>Source code for pytorchvideo.data.hmdb51</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">torch.utils.data</span>
<span class="kn">from</span> <span class="nn">iopath.common.file_io</span> <span class="kn">import</span> <span class="n">g_pathmgr</span>

<span class="kn">from</span> <span class="nn">.clip_sampling</span> <span class="kn">import</span> <span class="n">ClipSampler</span>
<span class="kn">from</span> <span class="nn">.encoded_video_dataset</span> <span class="kn">import</span> <span class="n">EncodedVideoDataset</span>


<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="Hmdb51LabeledVideoPaths"><a class="viewcode-back" href="../../../api/data/hmdb51.html#pytorchvideo.data.hmdb51.Hmdb51LabeledVideoPaths">[docs]</a><span class="k">class</span> <span class="nc">Hmdb51LabeledVideoPaths</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pre-processor for Hmbd51 dataset mentioned here -</span>
<span class="sd">        https://serre-lab.clps.brown.edu/resource/hmdb-a-large-human-motion-database/</span>

<span class="sd">    This dataset consists of classwise folds with each class consisting of 3</span>
<span class="sd">        folds (splits).</span>

<span class="sd">    The videos directory is of the format,</span>
<span class="sd">        video_dir_path/class_x/&lt;somevideo_name&gt;.avi</span>
<span class="sd">        ...</span>
<span class="sd">        video_dir_path/class_y/&lt;somevideo_name&gt;.avi</span>

<span class="sd">    The splits/fold directory is of the format,</span>
<span class="sd">        folds_dir_path/class_x_test_split_1.txt</span>
<span class="sd">        folds_dir_path/class_x_test_split_2.txt</span>
<span class="sd">        folds_dir_path/class_x_test_split_3.txt</span>
<span class="sd">        ...</span>
<span class="sd">        folds_dir_path/class_y_test_split_1.txt</span>
<span class="sd">        folds_dir_path/class_y_test_split_2.txt</span>
<span class="sd">        folds_dir_path/class_y_test_split_3.txt</span>

<span class="sd">    And each text file in the splits directory class_x_test_split_&lt;1 or 2 or 3&gt;.txt</span>
<span class="sd">        &lt;a video as in video_dir_path/class_x&gt; &lt;0 or 1 or 2&gt;</span>
<span class="sd">        where 0,1,2 corresponds to unused, train split respectively.</span>

<span class="sd">    Each video has name of format</span>
<span class="sd">        &lt;some_name&gt;_&lt;tag1&gt;_&lt;tag2&gt;_&lt;tag_3&gt;_&lt;tag4&gt;_&lt;tag5&gt;_&lt;some_id&gt;.avi</span>
<span class="sd">    For more details on tags -</span>
<span class="sd">        https://serre-lab.clps.brown.edu/resource/hmdb-a-large-human-motion-database/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_allowed_splits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">_split_type_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;unused&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<div class="viewcode-block" id="Hmdb51LabeledVideoPaths.from_dir"><a class="viewcode-back" href="../../../api/data/hmdb51.html#pytorchvideo.data.hmdb51.Hmdb51LabeledVideoPaths.from_dir">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dir</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">data_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">split_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">split_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hmdb51LabeledVideoPaths</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory function that creates Hmdb51LabeledVideoPaths object form a splits/folds</span>
<span class="sd">        directory.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_path (str): The path to the splits/folds directory of HMDB51.</span>
<span class="sd">            split_id (int): Fold id to be loaded. Belongs to [1,2,3]</span>
<span class="sd">            split_type (str): Split/Fold type to be loaded. It belongs to one of the</span>
<span class="sd">                following,</span>
<span class="sd">                - &quot;train&quot;</span>
<span class="sd">                - &quot;test&quot;</span>
<span class="sd">                - &quot;unused&quot; (This is a small set of videos that are neither</span>
<span class="sd">                of part of test or train fold.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">return</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_path</span><span class="si">}</span><span class="s2"> not found or is not a directory.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">(</span><span class="n">split_id</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_allowed_splits</span><span class="p">:</span>
            <span class="k">return</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">split_id</span><span class="si">}</span><span class="s2"> not found in allowed split id&#39;s </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">_allowed_splits</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="n">file_name_format</span> <span class="o">=</span> <span class="s2">&quot;_test_split&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">split_id</span><span class="p">))</span>
        <span class="n">file_paths</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">f</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">data_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.txt&quot;</span> <span class="ow">and</span> <span class="n">file_name_format</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">stem</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_csvs</span><span class="p">(</span><span class="n">file_paths</span><span class="p">,</span> <span class="n">split_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hmdb51LabeledVideoPaths.from_csvs"><a class="viewcode-back" href="../../../api/data/hmdb51.html#pytorchvideo.data.hmdb51.Hmdb51LabeledVideoPaths.from_csvs">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_csvs</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">file_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">split_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hmdb51LabeledVideoPaths</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory function that creates Hmdb51LabeledVideoPaths object form a list of</span>
<span class="sd">        split files of .txt type</span>

<span class="sd">        Args:</span>
<span class="sd">            file_paths (List[Union[pathlib.Path, str]]) : The path to the splits/folds</span>
<span class="sd">                    directory of HMDB51.</span>
<span class="sd">            split_type (str): Split/Fold type to be loaded.</span>
<span class="sd">                - &quot;train&quot;</span>
<span class="sd">                - &quot;test&quot;</span>
<span class="sd">                - &quot;unused&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">video_paths_and_label</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">file_paths</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">g_pathmgr</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> not found.&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.txt&quot;</span> <span class="ow">and</span> <span class="s2">&quot;_test_split&quot;</span> <span class="ow">in</span> <span class="n">file_path</span><span class="o">.</span><span class="n">stem</span><span class="p">):</span>
                <span class="k">return</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ivalid file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">action_name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span>
            <span class="n">action_name</span> <span class="o">=</span> <span class="n">action_name</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">file_path</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">with</span> <span class="n">g_pathmgr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">path_label</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
                    <span class="n">line_split</span> <span class="o">=</span> <span class="n">path_label</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">(</span><span class="n">line_split</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_split_type_dict</span><span class="p">[</span><span class="n">split_type</span><span class="p">]:</span>
                        <span class="k">continue</span>

                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">action_name</span><span class="p">,</span> <span class="n">line_split</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">meta_tags</span> <span class="o">=</span> <span class="n">line_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">video_paths_and_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">action_name</span><span class="p">,</span> <span class="s2">&quot;meta_tags&quot;</span><span class="p">:</span> <span class="n">meta_tags</span><span class="p">})</span>
                    <span class="p">)</span>

        <span class="k">assert</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">video_paths_and_label</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Failed to load dataset from </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">video_paths_and_label</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hmdb51LabeledVideoPaths.__init__"><a class="viewcode-back" href="../../../api/data/hmdb51.html#pytorchvideo.data.hmdb51.Hmdb51LabeledVideoPaths.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">paths_and_labels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]],</span> <span class="n">path_prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            paths_and_labels [(str, int)]: a list of tuples containing the video</span>
<span class="sd">                path and integer label.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_paths_and_labels</span> <span class="o">=</span> <span class="n">paths_and_labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_prefix</span> <span class="o">=</span> <span class="n">path_prefix</span></div>

    <span class="k">def</span> <span class="nf">path_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_prefix</span> <span class="o">=</span> <span class="n">prefix</span>

    <span class="n">path_prefix</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">path_prefix</span><span class="p">)</span>

<div class="viewcode-block" id="Hmdb51LabeledVideoPaths.__getitem__"><a class="viewcode-back" href="../../../api/data/hmdb51.html#pytorchvideo.data.hmdb51.Hmdb51LabeledVideoPaths.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            index (int): the path and label index.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The path and label tuple for the given index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paths_and_labels</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path_prefix</span><span class="p">,</span> <span class="n">path</span><span class="p">),</span> <span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hmdb51LabeledVideoPaths.__len__"><a class="viewcode-back" href="../../../api/data/hmdb51.html#pytorchvideo.data.hmdb51.Hmdb51LabeledVideoPaths.__len__">[docs]</a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            The number of video paths and label pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_paths_and_labels</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Hmdb51"><a class="viewcode-back" href="../../../api/data/hmdb51.html#pytorchvideo.data.hmdb51.Hmdb51">[docs]</a><span class="k">def</span> <span class="nf">Hmdb51</span><span class="p">(</span>
    <span class="n">data_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">clip_sampler</span><span class="p">:</span> <span class="n">ClipSampler</span><span class="p">,</span>
    <span class="n">video_sampler</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Sampler</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">RandomSampler</span><span class="p">,</span>
    <span class="n">transform</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">video_path_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">split_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">split_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
    <span class="n">decode_audio</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pyav&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EncodedVideoDataset</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A helper function to create EncodedVideoDataset object for HMDB51 dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        data_path (pathlib.Path): Path to the data. The path type defines how the</span>
<span class="sd">        data should be read:</span>
<span class="sd">            - For a file path, the file is read and each line is parsed into a</span>
<span class="sd">                video path and label.</span>
<span class="sd">            - For a directory, the directory structure defines the classes</span>
<span class="sd">                (i.e. each subdirectory is a class).</span>
<span class="sd">        See the LabeledVideoPaths class documentation for specific formatting</span>
<span class="sd">        details and examples.</span>

<span class="sd">        clip_sampler (ClipSampler): Defines how clips should be sampled from each</span>
<span class="sd">                video. See the clip sampling documentation for more information.</span>

<span class="sd">        video_sampler (Type[torch.utils.data.Sampler]): Sampler for the internal</span>
<span class="sd">                video container. This defines the order videos are decoded and,</span>
<span class="sd">                if necessary, the distributed split.</span>

<span class="sd">        transform (Callable): This callable is evaluated on the clip output before</span>
<span class="sd">                the clip is returned. It can be used for user defined preprocessing and</span>
<span class="sd">                augmentations to the clips. The clip output is a dictionary with the</span>
<span class="sd">                following format:</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;video&#39;: &lt;video_tensor&gt;,</span>
<span class="sd">                        &#39;label&#39;: &lt;index_label&gt;,</span>
<span class="sd">                        &#39;index&#39;: &lt;clip_index&gt;</span>
<span class="sd">                    }</span>
<span class="sd">                If transform is None, the raw clip output in the above format is</span>
<span class="sd">                returned unmodified.</span>

<span class="sd">        video_path_prefix (str): Path to root directory with the videos that are</span>
<span class="sd">                loaded in EncodedVideoDataset. All the video paths before loading</span>
<span class="sd">                are prefixed with this path.</span>

<span class="sd">        decoder (str): Defines which backend should be used to decode videos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">labeled_video_paths</span> <span class="o">=</span> <span class="n">Hmdb51LabeledVideoPaths</span><span class="o">.</span><span class="n">from_dir</span><span class="p">(</span>
        <span class="n">data_path</span><span class="p">,</span> <span class="n">split_id</span><span class="o">=</span><span class="n">split_id</span><span class="p">,</span> <span class="n">split_type</span><span class="o">=</span><span class="n">split_type</span>
    <span class="p">)</span>
    <span class="n">labeled_video_paths</span><span class="o">.</span><span class="n">path_prefix</span> <span class="o">=</span> <span class="n">video_path_prefix</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">EncodedVideoDataset</span><span class="p">(</span>
        <span class="n">labeled_video_paths</span><span class="p">,</span>
        <span class="n">clip_sampler</span><span class="p">,</span>
        <span class="n">video_sampler</span><span class="p">,</span>
        <span class="n">transform</span><span class="p">,</span>
        <span class="n">decode_audio</span><span class="o">=</span><span class="n">decode_audio</span><span class="p">,</span>
        <span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset</span></div>
</pre></div>

             </article>
             
            </div>
            <!-- <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, PyTorchVideo contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>
 -->
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
         <script src="../../../_static/jquery.js"></script>
         <script src="../../../_static/underscore.js"></script>
         <script src="../../../_static/doctools.js"></script>
         <script src="../../../_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->


  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebookâ€™s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../../../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorchvideo.org" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorchvideo.org">Home</a>
          </li>
          <li>
            <a href="https://pytorchvideo.org/docs/tutorial_overview">Tutorials</a>
          </li>
          <li>
            <a href="https://github.com/facebookresearch/pytorchvideo/">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>