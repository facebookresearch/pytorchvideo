


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pytorchvideo.models.stem &mdash; PyTorchVideo  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  
  
  
    <link rel="canonical" href="https://pytorchvideo.org/docs/_modules/pytorchvideo/models/stem.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorchvideo.org" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorchvideo.org">Home</a>
          </li>
          <li>
            <a href="https://pytorchvideo.org/docs/tutorial_overview">Tutorials</a>
          </li>
          <li>
            <a href="https://github.com/facebookresearch/pytorchvideo/">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/models.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/model_zoo.html">Model Zoo and Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/models/index.html">Models API</a></li>
</ul>
<p class="caption"><span class="caption-text">Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data_preparation.html">Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/data/index.html">Data API</a></li>
</ul>
<p class="caption"><span class="caption-text">Transforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/transforms.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/transforms/index.html">Transforms API</a></li>
</ul>
<p class="caption"><span class="caption-text">Layers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/layers.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/layers/index.html">Layers API</a></li>
</ul>
<p class="caption"><span class="caption-text">Accelerator</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/accelerator.html">Overview</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../index.html">Module code</a> &gt;</li>
        
      <li>pytorchvideo.models.stem</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>Source code for pytorchvideo.models.stem</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) Facebook, Inc. and its affiliates. All Rights Reserved.</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">pytorchvideo.layers.convolutions</span> <span class="kn">import</span> <span class="n">ConvReduce3D</span>
<span class="kn">from</span> <span class="nn">pytorchvideo.layers.utils</span> <span class="kn">import</span> <span class="n">set_attributes</span>


<div class="viewcode-block" id="create_res_basic_stem"><a class="viewcode-back" href="../../../api/models/stem.html#pytorchvideo.models.stem.create_res_basic_stem">[docs]</a><span class="k">def</span> <span class="nf">create_res_basic_stem</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="c1"># Conv configs.</span>
    <span class="n">in_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">out_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">conv_kernel_size</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
    <span class="n">conv_stride</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">conv_padding</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">conv_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">conv</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">,</span>
    <span class="c1"># Pool configs.</span>
    <span class="n">pool</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool3d</span><span class="p">,</span>
    <span class="n">pool_kernel_size</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">pool_stride</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">pool_padding</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="c1"># BN configs.</span>
    <span class="n">norm</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm3d</span><span class="p">,</span>
    <span class="n">norm_eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">norm_momentum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="c1"># Activation configs.</span>
    <span class="n">activation</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates the basic resnet stem layer. It performs spatiotemporal Convolution, BN, and</span>
<span class="sd">    Relu following by a spatiotemporal pooling.</span>

<span class="sd">    ::</span>

<span class="sd">                                        Conv3d</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                     Normalization</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                       Activation</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                        Pool3d</span>

<span class="sd">    Normalization options include: BatchNorm3d and None (no normalization).</span>
<span class="sd">    Activation options include: ReLU, Softmax, Sigmoid, and None (no activation).</span>
<span class="sd">    Pool3d options include: AvgPool3d, MaxPool3d, and None (no pooling).</span>

<span class="sd">    Args:</span>

<span class="sd">        in_channels (int): input channel size of the convolution.</span>
<span class="sd">        out_channels (int): output channel size of the convolution.</span>
<span class="sd">        conv_kernel_size (tuple): convolutional kernel size(s).</span>
<span class="sd">        conv_stride (tuple): convolutional stride size(s).</span>
<span class="sd">        conv_padding (tuple): convolutional padding size(s).</span>
<span class="sd">        conv_bias (bool): convolutional bias. If true, adds a learnable bias to the</span>
<span class="sd">            output.</span>
<span class="sd">        conv (callable): Callable used to build the convolution layer.</span>

<span class="sd">        pool (callable): a callable that constructs pooling layer, options include:</span>
<span class="sd">            nn.AvgPool3d, nn.MaxPool3d, and None (not performing pooling).</span>
<span class="sd">        pool_kernel_size (tuple): pooling kernel size(s).</span>
<span class="sd">        pool_stride (tuple): pooling stride size(s).</span>
<span class="sd">        pool_padding (tuple): pooling padding size(s).</span>

<span class="sd">        norm (callable): a callable that constructs normalization layer, options</span>
<span class="sd">            include nn.BatchNorm3d, None (not performing normalization).</span>
<span class="sd">        norm_eps (float): normalization epsilon.</span>
<span class="sd">        norm_momentum (float): normalization momentum.</span>

<span class="sd">        activation (callable): a callable that constructs activation layer, options</span>
<span class="sd">            include: nn.ReLU, nn.Softmax, nn.Sigmoid, and None (not performing</span>
<span class="sd">            activation).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (nn.Module): resnet basic stem layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">conv_module</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span>
        <span class="n">in_channels</span><span class="o">=</span><span class="n">in_channels</span><span class="p">,</span>
        <span class="n">out_channels</span><span class="o">=</span><span class="n">out_channels</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="n">conv_kernel_size</span><span class="p">,</span>
        <span class="n">stride</span><span class="o">=</span><span class="n">conv_stride</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="n">conv_padding</span><span class="p">,</span>
        <span class="n">bias</span><span class="o">=</span><span class="n">conv_bias</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">norm_module</span> <span class="o">=</span> <span class="p">(</span>
        <span class="kc">None</span>
        <span class="k">if</span> <span class="n">norm</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">norm</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="n">out_channels</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">norm_eps</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="n">norm_momentum</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">activation_module</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">activation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">activation</span><span class="p">()</span>
    <span class="n">pool_module</span> <span class="o">=</span> <span class="p">(</span>
        <span class="kc">None</span>
        <span class="k">if</span> <span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">pool</span><span class="p">(</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="n">pool_kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">pool_stride</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">pool_padding</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ResNetBasicStem</span><span class="p">(</span>
        <span class="n">conv</span><span class="o">=</span><span class="n">conv_module</span><span class="p">,</span>
        <span class="n">norm</span><span class="o">=</span><span class="n">norm_module</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">activation_module</span><span class="p">,</span>
        <span class="n">pool</span><span class="o">=</span><span class="n">pool_module</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="create_acoustic_res_basic_stem"><a class="viewcode-back" href="../../../api/models/stem.html#pytorchvideo.models.stem.create_acoustic_res_basic_stem">[docs]</a><span class="k">def</span> <span class="nf">create_acoustic_res_basic_stem</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="c1"># Conv configs.</span>
    <span class="n">in_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">out_channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">conv_kernel_size</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
    <span class="n">conv_stride</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">conv_padding</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">conv_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="c1"># Pool configs.</span>
    <span class="n">pool</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool3d</span><span class="p">,</span>
    <span class="n">pool_kernel_size</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">pool_stride</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">pool_padding</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="c1"># BN configs.</span>
    <span class="n">norm</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm3d</span><span class="p">,</span>
    <span class="n">norm_eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">norm_momentum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="c1"># Activation configs.</span>
    <span class="n">activation</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates the acoustic resnet stem layer. It performs a spatial and a temporal</span>
<span class="sd">    Convolution in parallel, then performs, BN, and Relu following by a spatiotemporal</span>
<span class="sd">    pooling.</span>

<span class="sd">    ::</span>

<span class="sd">                                    Conv3d   Conv3d</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                     Normalization</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                       Activation</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                        Pool3d</span>

<span class="sd">    Normalization options include: BatchNorm3d and None (no normalization).</span>
<span class="sd">    Activation options include: ReLU, Softmax, Sigmoid, and None (no activation).</span>
<span class="sd">    Pool3d options include: AvgPool3d, MaxPool3d, and None (no pooling).</span>

<span class="sd">    Args:</span>
<span class="sd">        in_channels (int): input channel size of the convolution.</span>
<span class="sd">        out_channels (int): output channel size of the convolution.</span>
<span class="sd">        conv_kernel_size (tuple): convolutional kernel size(s).</span>
<span class="sd">        conv_stride (tuple): convolutional stride size(s), it will be performed as</span>
<span class="sd">            temporal and spatial convolution in parallel.</span>
<span class="sd">        conv_padding (tuple): convolutional padding size(s), it  will be performed</span>
<span class="sd">            as temporal and spatial convolution in parallel.</span>
<span class="sd">        conv_bias (bool): convolutional bias. If true, adds a learnable bias to the</span>
<span class="sd">            output.</span>

<span class="sd">        pool (callable): a callable that constructs pooling layer, options include:</span>
<span class="sd">            nn.AvgPool3d, nn.MaxPool3d, and None (not performing pooling).</span>
<span class="sd">        pool_kernel_size (tuple): pooling kernel size(s).</span>
<span class="sd">        pool_stride (tuple): pooling stride size(s).</span>
<span class="sd">        pool_padding (tuple): pooling padding size(s).</span>

<span class="sd">        norm (callable): a callable that constructs normalization layer, options</span>
<span class="sd">            include nn.BatchNorm3d, None (not performing normalization).</span>
<span class="sd">        norm_eps (float): normalization epsilon.</span>
<span class="sd">        norm_momentum (float): normalization momentum.</span>

<span class="sd">        activation (callable): a callable that constructs activation layer, options</span>
<span class="sd">            include: nn.ReLU, nn.Softmax, nn.Sigmoid, and None (not performing</span>
<span class="sd">            activation).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (nn.Module): resnet basic stem layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">conv_module</span> <span class="o">=</span> <span class="n">ConvReduce3D</span><span class="p">(</span>
        <span class="n">in_channels</span><span class="o">=</span><span class="n">in_channels</span><span class="p">,</span>
        <span class="n">out_channels</span><span class="o">=</span><span class="n">out_channels</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span>
            <span class="c1"># Temporal conv kernel size.</span>
            <span class="p">(</span><span class="n">conv_kernel_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="c1"># Spatial conv kernel size.</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">conv_kernel_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">conv_kernel_size</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
        <span class="p">),</span>
        <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="n">conv_stride</span><span class="p">,</span> <span class="n">conv_stride</span><span class="p">),</span>
        <span class="n">padding</span><span class="o">=</span><span class="p">((</span><span class="n">conv_padding</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">conv_padding</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">conv_padding</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span>
        <span class="n">bias</span><span class="o">=</span><span class="p">(</span><span class="n">conv_bias</span><span class="p">,</span> <span class="n">conv_bias</span><span class="p">),</span>
        <span class="n">reduction_method</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">norm_module</span> <span class="o">=</span> <span class="p">(</span>
        <span class="kc">None</span>
        <span class="k">if</span> <span class="n">norm</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">norm</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="n">out_channels</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">norm_eps</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="n">norm_momentum</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">activation_module</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">activation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">activation</span><span class="p">()</span>
    <span class="n">pool_module</span> <span class="o">=</span> <span class="p">(</span>
        <span class="kc">None</span>
        <span class="k">if</span> <span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">pool</span><span class="p">(</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="n">pool_kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">pool_stride</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">pool_padding</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ResNetBasicStem</span><span class="p">(</span>
        <span class="n">conv</span><span class="o">=</span><span class="n">conv_module</span><span class="p">,</span>
        <span class="n">norm</span><span class="o">=</span><span class="n">norm_module</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="n">activation_module</span><span class="p">,</span>
        <span class="n">pool</span><span class="o">=</span><span class="n">pool_module</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="ResNetBasicStem"><a class="viewcode-back" href="../../../api/models/stem.html#pytorchvideo.models.stem.ResNetBasicStem">[docs]</a><span class="k">class</span> <span class="nc">ResNetBasicStem</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ResNet basic 3D stem module. Performs spatiotemporal Convolution, BN, and activation</span>
<span class="sd">    following by a spatiotemporal pooling.</span>

<span class="sd">    ::</span>

<span class="sd">                                        Conv3d</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                     Normalization</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                       Activation</span>
<span class="sd">                                           ↓</span>
<span class="sd">                                        Pool3d</span>

<span class="sd">    The builder can be found in `create_res_basic_stem`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ResNetBasicStem.__init__"><a class="viewcode-back" href="../../../api/models/stem.html#pytorchvideo.models.stem.ResNetBasicStem.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">conv</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">norm</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">activation</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pool</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            conv (torch.nn.modules): convolutional module.</span>
<span class="sd">            norm (torch.nn.modules): normalization module.</span>
<span class="sd">            activation (torch.nn.modules): activation module.</span>
<span class="sd">            pool (torch.nn.modules): pooling module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">set_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span></div>
</pre></div>

             </article>
             
            </div>
            <!-- <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, PyTorchVideo contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>
 -->
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
         <script src="../../../_static/jquery.js"></script>
         <script src="../../../_static/underscore.js"></script>
         <script src="../../../_static/doctools.js"></script>
         <script src="../../../_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->


  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../../../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorchvideo.org" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorchvideo.org">Home</a>
          </li>
          <li>
            <a href="https://pytorchvideo.org/docs/tutorial_overview">Tutorials</a>
          </li>
          <li>
            <a href="https://github.com/facebookresearch/pytorchvideo/">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>