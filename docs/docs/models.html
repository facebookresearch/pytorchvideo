


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Overview &mdash; PyTorchVideo  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  
    <link rel="canonical" href="https://pytorchvideo.org/docs/docs/models.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Model Zoo and Benchmarks" href="model_zoo.html" />
    <link rel="prev" title="PyTorchVideo Documentation" href="../index.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorchvideo.org" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorchvideo.org">Home</a>
          </li>
          <li>
            <a href="https://pytorchvideo.org/docs/tutorial_overview">Tutorials</a>
          </li>
          <li>
            <a href="https://github.com/facebookresearch/pytorchvideo/">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Models</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_zoo.html">Model Zoo and Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/models/index.html">Models API</a></li>
</ul>
<p class="caption"><span class="caption-text">Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_preparation.html">Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/data/index.html">Data API</a></li>
</ul>
<p class="caption"><span class="caption-text">Transforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/transforms/index.html">Transforms API</a></li>
</ul>
<p class="caption"><span class="caption-text">Layers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="layers.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/layers/index.html">Layers API</a></li>
</ul>
<p class="caption"><span class="caption-text">Accelerator</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="accelerator.html">Overview</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Overview</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/docs/models.md.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>PyTorchVideo is an open source video understanding library that provides up to date builders for state of the art video understanding backbones, layers, heads, and losses addressing different tasks, including acoustic event detection, action recognition (video classification), action detection (video detection), multimodal understanding (acoustic visual classification), self-supervised learning.</p>
<p>The models subpackage contains definitions for the following model architectures and layers:</p>
<ul class="simple">
<li><p>Acoustic Backbone</p>
<ul>
<li><p>Acoustic ResNet</p></li>
</ul>
</li>
<li><p>Visual Backbone</p>
<ul>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1705.07750.pdf">I3D</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1711.07971.pdf">C2D</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1709.01507.pdf">Squeeze-and-Excitation Networks</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1711.07971.pdf">Nonlocal Networks</a></p></li>
<li><p><a class="reference external" href="https://openaccess.thecvf.com/content_cvpr_2018/papers/Tran_A_Closer_Look_CVPR_2018_paper.pdf">R2+1D</a></p></li>
<li><p>CSN</p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1812.03982.pdf">SlowFast</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/2004.04730.pdf">X3D</a></p></li>
</ul>
</li>
<li><p>Self-Supervised Learning</p>
<ul>
<li><p><a class="reference external" href="https://arxiv.org/pdf/2002.05709.pdf">SimCLR</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/2006.07733.pdf">Bootstrap Your Own Latent</a></p></li>
<li><p><a class="reference external" href="https://openaccess.thecvf.com/content_cvpr_2018/CameraReady/0801.pdf">Non-Parametric Instance Discrimination</a></p></li>
</ul>
</li>
</ul>
<div class="section" id="build-standard-models">
<h2>Build standard models<a class="headerlink" href="#build-standard-models" title="Permalink to this headline">¶</a></h2>
<p>PyTorchVideo provide default builders to construct state-of-the-art video understanding models, layers, heads, and losses.</p>
<div class="section" id="models">
<h3>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h3>
<p>You can construct a model with random weights by calling its constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytorchvideo.models</span> <span class="k">as</span> <span class="nn">models</span>

<span class="n">resnet</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">create_resnet</span><span class="p">()</span>
<span class="n">acoustic_resnet</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">create_acoustic_resnet</span><span class="p">()</span>
<span class="n">slowfast</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">create_slowfast</span><span class="p">()</span>
<span class="n">x3d</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">create_x3d</span><span class="p">()</span>
<span class="n">r2plus1d</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">create_r2plus1d</span><span class="p">()</span>
<span class="n">csn</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">create_csn</span><span class="p">()</span>
</pre></div>
</div>
<p>You can verify whether you have built the model successfully by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytorchvideo.models</span> <span class="k">as</span> <span class="nn">models</span>

<span class="n">resnet</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">create_resnet</span><span class="p">()</span>
<span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="layers">
<h3>Layers<a class="headerlink" href="#layers" title="Permalink to this headline">¶</a></h3>
<p>You can construct a layer with random weights by calling its constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytorchvideo.layers</span> <span class="k">as</span> <span class="nn">layers</span>

<span class="k">nonlocal</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">create_nonlocal</span><span class="p">(</span><span class="n">dim_in</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dim_inner</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="n">swish</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Swish</span><span class="p">()</span>
<span class="n">conv_2plus1d</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">create_conv_2plus1d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
</pre></div>
</div>
<p>You can verify whether you have built the model successfully by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytorchvideo.layers</span> <span class="k">as</span> <span class="nn">layers</span>

<span class="k">nonlocal</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">create_nonlocal</span><span class="p">(</span><span class="n">dim_in</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">dim_inner</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="k">nonlocal</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>

<span class="n">swish</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Swish</span><span class="p">()</span>
<span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">swish</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>

<span class="n">conv_2plus1d</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">create_conv_2plus1d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
<span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">conv_2plus1d</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="heads">
<h3>Heads<a class="headerlink" href="#heads" title="Permalink to this headline">¶</a></h3>
<p>You can construct a head with random weights by calling its constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytorchvideo.models</span> <span class="k">as</span> <span class="nn">models</span>

<span class="n">res_head</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">create_res_basic_head</span><span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span>
<span class="n">x3d_head</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">x3d</span><span class="o">.</span><span class="n">create_x3d_head</span><span class="p">(</span><span class="n">dim_in</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">dim_inner</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">dim_out</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
<p>You can verify whether you have built the head successfully by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytorchvideo.models</span> <span class="k">as</span> <span class="nn">models</span>

<span class="n">res_head</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">create_res_basic_head</span><span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span>
<span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">res_head</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>

<span class="n">x3d_head</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">x3d</span><span class="o">.</span><span class="n">create_x3d_head</span><span class="p">(</span><span class="n">dim_in</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">dim_inner</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">dim_out</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">x3d_head</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="losses">
<h3>Losses<a class="headerlink" href="#losses" title="Permalink to this headline">¶</a></h3>
<p>You can construct a loss by calling its constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytorchvideo.models</span> <span class="k">as</span> <span class="nn">models</span>

<span class="n">simclr_loss</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SimCLR</span><span class="p">()</span>
</pre></div>
</div>
<p>You can verify whether you have built the loss successfully by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytorchvideo.models</span> <span class="k">as</span> <span class="nn">models</span>
<span class="kn">import</span> <span class="nn">pytorchvideo.layers</span> <span class="k">as</span> <span class="nn">layers</span>

<span class="n">resnet</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">create_resnet</span><span class="p">()</span>
<span class="n">mlp</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">make_multilayer_perceptron</span><span class="p">(</span><span class="n">fully_connected_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2048</span><span class="p">))</span>
<span class="n">simclr_loss</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SimCLR</span><span class="p">(</span><span class="n">mlp</span><span class="o">=</span><span class="n">mlp</span><span class="p">,</span> <span class="n">backbone</span><span class="o">=</span><span class="n">resnet</span><span class="p">)</span>
<span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span>
<span class="n">view1</span><span class="p">,</span> <span class="n">view2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">simclr_loss</span><span class="p">(</span><span class="n">view1</span><span class="p">,</span> <span class="n">view2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="build-customized-models">
<h2>Build customized models<a class="headerlink" href="#build-customized-models" title="Permalink to this headline">¶</a></h2>
<p>PyTorchVideo also supports building models with customized components, which is an important feature for video understanding research. Here we take a standard stem model as an example, show how to build each resnet components (head, backbone, stem) separately, and how to use your customized components to replace standard components.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pytorchvideo.models.stem</span> <span class="kn">import</span> <span class="n">create_res_basic_stem</span>


<span class="c1"># Create standard stem layer.</span>
<span class="n">stem</span> <span class="o">=</span> <span class="n">create_res_basic_stem</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>

<span class="c1"># Create customized stem layer with YourFancyNorm</span>
<span class="n">stem</span> <span class="o">=</span> <span class="n">create_res_basic_stem</span><span class="p">(</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> 
    <span class="n">norm</span><span class="o">=</span><span class="n">YourFancyNorm</span><span class="p">,</span>  <span class="c1"># GhostNorm for example</span>
<span class="p">)</span>

<span class="c1"># Create customized stem layer with YourFancyConv</span>
<span class="n">stem</span> <span class="o">=</span> <span class="n">create_res_basic_stem</span><span class="p">(</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> 
    <span class="n">conv</span><span class="o">=</span><span class="n">YourFancyConv</span><span class="p">,</span>  <span class="c1"># OctConv for example</span>
<span class="p">)</span>

<span class="c1"># Create customized stem layer with YourFancyAct</span>
<span class="n">stem</span> <span class="o">=</span> <span class="n">create_res_basic_stem</span><span class="p">(</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> 
    <span class="n">activation</span><span class="o">=</span><span class="n">YourFancyAct</span><span class="p">,</span>  <span class="c1"># Swish for example</span>
<span class="p">)</span>

<span class="c1"># Create customized stem layer with YourFancyPool</span>
<span class="n">stem</span> <span class="o">=</span> <span class="n">create_res_basic_stem</span><span class="p">(</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> 
    <span class="n">pool</span><span class="o">=</span><span class="n">YourFancyPool</span><span class="p">,</span>  <span class="c1"># MinPool for example</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>


             </article>
             
            </div>
            <!-- <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="model_zoo.html" class="btn btn-neutral float-right" title="Model Zoo and Benchmarks" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="PyTorchVideo Documentation" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, PyTorchVideo contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>
 -->
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Overview</a><ul>
<li><a class="reference internal" href="#build-standard-models">Build standard models</a><ul>
<li><a class="reference internal" href="#models">Models</a></li>
<li><a class="reference internal" href="#layers">Layers</a></li>
<li><a class="reference internal" href="#heads">Heads</a></li>
<li><a class="reference internal" href="#losses">Losses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#build-customized-models">Build customized models</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/doctools.js"></script>
         <script src="../_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->


  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorchvideo.org" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorchvideo.org">Home</a>
          </li>
          <li>
            <a href="https://pytorchvideo.org/docs/tutorial_overview">Tutorials</a>
          </li>
          <li>
            <a href="https://github.com/facebookresearch/pytorchvideo/">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>